
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
                    <!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="description" content=""> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Cylindrical cosmological simulations with StePS</title> <link rel="stylesheet" type="text/css" href="/assets/css/default.css"> <link rel="stylesheet" type="text/css" href="/assets/css/navbar.css"> <!-- Accumulated head injections from layouts and pages --> <link rel="stylesheet" href="/assets/css/pages.css"> <link rel="stylesheet" href="/assets/css/media.css"> <link rel="stylesheet" href="/assets/css/tables.css"> <link rel="stylesheet" href="/assets/css/projects.css"> <!-- Icons --> <link rel="icon" href="/assets/images/icons/icon.svg"> <link rel="mask-icon" href="/assets/images/icons/mask-icon.svg" color="#000000"> <link rel="apple-touch-icon" href="/assets/images/icons/apple-touch-icon.png"> </head> <body> <!--HEAD_EXTRA <link rel="stylesheet" href="/assets/css/pages.css"> <link rel="stylesheet" href="/assets/css/media.css"> <link rel="stylesheet" href="/assets/css/tables.css"> HEAD_EXTRA--> <div id="content"> <div id="header-container"> <a href="/"> ELTEVO HEADER PLACEHOLDER <!-- <img id="header-image" src="/assets/images/header/header.svg" alt="masterdesky"> --> </a> </div> <nav class="main-navigation"> <ul class="menu list-unstyled"> <li> <a href="/">Home</a> </li> <li> <a href="/projects/" class="active">Projects</a> </li> <li> <a href="/about/">About</a> </li> </ul> </nav> <div id="document"> <!--HEAD_EXTRA <link rel="stylesheet" href="/assets/css/projects.css"> HEAD_EXTRA--> <header id="post-header"> <h1>Cylindrical cosmological simulations with StePS</h1> <h2><i></i></h2> </header> <aside id="post-info"> <!-- <span class="author"><i>by:</i> </span> --> <div class="post-dates"> <span class="posted-date"> Posted &#8212 2026-02-22 </span> <span class="edited-date"> Last edited &#8212 2026-02-21 - 15:16 </span> </div> </aside> <div id="post-content"> <h2 id="overview">Overview</h2> <p>The global topology of the Universe can affect the long‑range gravitational forces through the boundary conditions. To study non-trivial topologies in detail, simulations that natively adopt such geometries are required. In this project, we introduce a compactified simulation framework that is only periodic along a single axis, while having infinite topology with isotropic boundary conditions towards the perpendicular directions. This non-trivial $S^1\times\mathbb{R}^2$ topological manifold has cylindrical symmetry, and the Lagrangian of a self-gravitating particle system in this space is invariant under translation along the cylinder’s axis. As a consequence of Noether’s theorem, the linear momentum along the cylinder’s axis and the angular momentum along the same axis are both conserved. Such a topology is particularly well-suited for studying naturally anisotropic environments such as filamentary structures.</p> <h2 id="main-simulation">Main simulation</h2> <p>To demonstrate the new simulation method, we run a new cosmological $N$-body simulation with our <a href="https://github.com/eltevo/StePS">StePS</a> simulation code in $S^1\times\mathbb{R}^2$ topology. We used best-fit Planck 2018 $\Lambda$CDM cosmological parameters, and a 2LPT method to generate the initial conditions of a periodic cylinder with height $L_{z} = 1.0\,\mathrm{Gpc}$, resolved radius $R_{\mathrm{sim}}= 500\,\mathrm{Mpc}$, and $N_{p} = 2.4 \cdot 10^7$ dark matter particles. The generated particle snapshots, halo catalogues, power spectra, and example notebooks can be downloaded from here.</p> <h2 id="download-links">Download links</h2> <h3 id="snapshots">Snapshots</h3> <p>These files are the primary output of the Simulation. They are in GAGDET-compatible <a href="https://www.hdfgroup.org/solutions/hdf5/">HDF5</a> format, and containing particle positions, velocities, masses, and IDs. Overall 138 snapshots were saved during the simulation. These can be visualized with <a href="https://github.com/jchelly/gadgetviewer">gadgetviewer</a> or <a href="https://github.com/pynbody/topsy">topsy</a>.</p> <figure class="image" style="display: flex; justify-content: center;"> <video autoplay="" loop="" muted="" playsinline="" style="width: 100%; height: auto;" poster=""> <source src="/assets/images/projects/cylindrical-simulation/CylindricalExampleCenter.webm" type="video/webm" /> Your browser does not support the video tag. </video> </figure> <p><strong>Uncompressed size:</strong> 1.5 GB / snapshot</p> <p><strong>Mirrors</strong></p> <ul> <li>ELTE Kooplex: TBA</li> <li>helsinkifi-my.sharepoint.com (only 4 snapshots): <a href="https://helsinkifi-my.sharepoint.com/:f:/g/personal/gracz_ad_helsinki_fi/IgCmwFcqlHBiTZ-Jdp1bfwV8AQq4NnzWcJJwmDV4h4-rn6o?e=GJVG1a">Download</a></li> </ul> <hr /> <h3 id="power-spectra">Power spectra</h3> <figure class="image"> <button type="button" class="zoom-trigger"> <img src="/assets/images/projects/cylindrical-simulation/LCDM_N24M_Sim_Pk_all.svg" alt="Real-space dark matter power spectra of all available snapshots" /> </button> </figure> <p>The isotropic $P(k)$ power spectrum of the dark matter density field is a standard statistic used to quantify the clustering. We estimated the power spectra from particle snapshots using the Feldman–Kaiser–Peacock (FKP) method.</p> <p><strong>Mirrors</strong></p> <ul> <li>ELTE Kooplex: TBA</li> <li>helsinkifi-my.sharepoint.com: <a href="https://helsinkifi-my.sharepoint.com/:u:/g/personal/gracz_ad_helsinki_fi/IQCfdHpygkwOQJM4R0hAF0a9ASukMk5devFf7r6rWDY6O6k?e=Sj8kEo">Download</a></li> </ul> <hr /> <h3 id="halo-catalogues">Halo Catalogues</h3> <p>These files contain all available information about the identified haloes. The haloes were identified with our own StePS_HF Spherical Overdensity (SO) halo finder code. Two formats are available to download:</p> <ol class="catalogue-formats"> <li> <details> <summary><strong>ASCII</strong> &mdash; one halo per row (click to expand)</summary> <nav class="field-nav"> <a href="#identity">Identity and basics</a> <a href="#virial">Virial sphere</a> <a href="#m200b">200b</a> <a href="#m200c">200c</a> <a href="#m500c">500c</a> <a href="#m1000c">1000c</a> <a href="#m2500c">2500c</a> </nav> <section id="identity" class="field-group"> <h4>Identity and basics</h4> <p>Halo identification and fundamental properties.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>1</td> <td><code>ID</code></td> <td>Unique halo identifier</td> </tr> <tr> <td>2</td> <td><code>Npart</code></td> <td>Number of particles</td> </tr> <tr> <td>3</td> <td><code>VolResolved</code></td> <td>Volume-resolved flag</td> </tr> <tr> <td>4</td> <td><code>Mvir</code></td> <td>Virial mass</td> </tr> </tbody> </table> </section> <section id="virial" class="field-group"> <h4>Virial sphere</h4> <p>Properties measured within the virial radius. Also contains \(V_{\rm Max}\) and the Klypin scale radius, which are unique to this group.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>5</td> <td><code>X</code></td> <td>Position X</td> </tr> <tr> <td>6</td> <td><code>Y</code></td> <td>Position Y</td> </tr> <tr> <td>7</td> <td><code>Z</code></td> <td>Position Z</td> </tr> <tr> <td>8</td> <td><code>Rvir</code></td> <td>Virial radius</td> </tr> <tr> <td>9</td> <td><code>Vvir_X</code></td> <td>Velocity X</td> </tr> <tr> <td>10</td> <td><code>Vvir_Y</code></td> <td>Velocity Y</td> </tr> <tr> <td>11</td> <td><code>Vvir_Z</code></td> <td>Velocity Z</td> </tr> <tr> <td>12</td> <td><code>VRMSvir</code></td> <td>RMS velocity dispersion</td> </tr> <tr> <td>13</td> <td><code>Vcircvir</code></td> <td>Circular velocity</td> </tr> <tr> <td>14</td> <td><code>VMax</code></td> <td>Maximum circular velocity</td> </tr> <tr> <td>15</td> <td><code>Rs_klypin</code></td> <td>Scale radius (Klypin definition)</td> </tr> <tr> <td>16</td> <td><code>Jvir_X</code></td> <td>Angular momentum X</td> </tr> <tr> <td>17</td> <td><code>Jvir_Y</code></td> <td>Angular momentum Y</td> </tr> <tr> <td>18</td> <td><code>Jvir_Z</code></td> <td>Angular momentum Z</td> </tr> <tr> <td>19</td> <td><code>Spin_Bullock</code></td> <td>Spin parameter (Bullock et al.)</td> </tr> </tbody> </table> </section> <section id="m200b" class="field-group"> <h4>200b</h4> <p>Properties within R200b &mdash; radius enclosing mean density 200 times the background density.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>20</td> <td><code>M200b</code></td> <td>Mass</td> </tr> <tr> <td>21</td> <td><code>R200b</code></td> <td>Radius</td> </tr> <tr> <td>22</td> <td><code>V200b_X</code></td> <td>Velocity X</td> </tr> <tr> <td>23</td> <td><code>V200b_Y</code></td> <td>Velocity Y</td> </tr> <tr> <td>24</td> <td><code>V200b_Z</code></td> <td>Velocity Z</td> </tr> <tr> <td>25</td> <td><code>VRMS200b</code></td> <td>RMS velocity dispersion</td> </tr> <tr> <td>26</td> <td><code>Vcirc200b</code></td> <td>Circular velocity</td> </tr> <tr> <td>27</td> <td><code>J200b_X</code></td> <td>Angular momentum X</td> </tr> <tr> <td>28</td> <td><code>J200b_Y</code></td> <td>Angular momentum Y</td> </tr> <tr> <td>29</td> <td><code>J200b_Z</code></td> <td>Angular momentum Z</td> </tr> </tbody> </table> </section> <section id="m200c" class="field-group"> <h4>200c</h4> <p>Properties within R200c &mdash; radius enclosing mean density 200 times the critical density.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>30</td> <td><code>M200c</code></td> <td>Mass</td> </tr> <tr> <td>31</td> <td><code>R200c</code></td> <td>Radius</td> </tr> <tr> <td>32</td> <td><code>V200c_X</code></td> <td>Velocity X</td> </tr> <tr> <td>33</td> <td><code>V200c_Y</code></td> <td>Velocity Y</td> </tr> <tr> <td>34</td> <td><code>V200c_Z</code></td> <td>Velocity Z</td> </tr> <tr> <td>35</td> <td><code>VRMS200c</code></td> <td>RMS velocity dispersion</td> </tr> <tr> <td>36</td> <td><code>Vcirc200c</code></td> <td>Circular velocity</td> </tr> <tr> <td>37</td> <td><code>J200c_X</code></td> <td>Angular momentum X</td> </tr> <tr> <td>38</td> <td><code>J200c_Y</code></td> <td>Angular momentum Y</td> </tr> <tr> <td>39</td> <td><code>J200c_Z</code></td> <td>Angular momentum Z</td> </tr> </tbody> </table> </section> <section id="m500c" class="field-group"> <h4>500c</h4> <p>Properties within R500c &mdash; radius enclosing mean density 500 times the critical density.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>40</td> <td><code>M500c</code></td> <td>Mass</td> </tr> <tr> <td>41</td> <td><code>R500c</code></td> <td>Radius</td> </tr> <tr> <td>42</td> <td><code>V500c_X</code></td> <td>Velocity X</td> </tr> <tr> <td>43</td> <td><code>V500c_Y</code></td> <td>Velocity Y</td> </tr> <tr> <td>44</td> <td><code>V500c_Z</code></td> <td>Velocity Z</td> </tr> <tr> <td>45</td> <td><code>VRMS500c</code></td> <td>RMS velocity dispersion</td> </tr> <tr> <td>46</td> <td><code>Vcirc500c</code></td> <td>Circular velocity</td> </tr> <tr> <td>47</td> <td><code>J500c_X</code></td> <td>Angular momentum X</td> </tr> <tr> <td>48</td> <td><code>J500c_Y</code></td> <td>Angular momentum Y</td> </tr> <tr> <td>49</td> <td><code>J500c_Z</code></td> <td>Angular momentum Z</td> </tr> </tbody> </table> </section> <section id="m1000c" class="field-group"> <h4>1000c</h4> <p>Properties within R1000c &mdash; radius enclosing mean density 1000 times the critical density.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>50</td> <td><code>M1000c</code></td> <td>Mass</td> </tr> <tr> <td>51</td> <td><code>R1000c</code></td> <td>Radius</td> </tr> <tr> <td>52</td> <td><code>V1000c_X</code></td> <td>Velocity X</td> </tr> <tr> <td>53</td> <td><code>V1000c_Y</code></td> <td>Velocity Y</td> </tr> <tr> <td>54</td> <td><code>V1000c_Z</code></td> <td>Velocity Z</td> </tr> <tr> <td>55</td> <td><code>VRMS1000c</code></td> <td>RMS velocity dispersion</td> </tr> <tr> <td>56</td> <td><code>Vcirc1000c</code></td> <td>Circular velocity</td> </tr> <tr> <td>57</td> <td><code>J1000c_X</code></td> <td>Angular momentum X</td> </tr> <tr> <td>58</td> <td><code>J1000c_Y</code></td> <td>Angular momentum Y</td> </tr> <tr> <td>59</td> <td><code>J1000c_Z</code></td> <td>Angular momentum Z</td> </tr> </tbody> </table> </section> <section id="m2500c" class="field-group"> <h4>2500c</h4> <p>Properties within R2500c &mdash; radius enclosing mean density 2500 times the critical density.</p> <table> <thead> <tr><th>Column index</th><th>Field</th><th>Description</th></tr> </thead> <tbody> <tr> <td>60</td> <td><code>M2500c</code></td> <td>Mass</td> </tr> <tr> <td>61</td> <td><code>R2500c</code></td> <td>Radius</td> </tr> <tr> <td>62</td> <td><code>V2500c_X</code></td> <td>Velocity X</td> </tr> <tr> <td>63</td> <td><code>V2500c_Y</code></td> <td>Velocity Y</td> </tr> <tr> <td>64</td> <td><code>V2500c_Z</code></td> <td>Velocity Z</td> </tr> <tr> <td>65</td> <td><code>VRMS2500c</code></td> <td>RMS velocity dispersion</td> </tr> <tr> <td>66</td> <td><code>Vcirc2500c</code></td> <td>Circular velocity</td> </tr> <tr> <td>67</td> <td><code>J2500c_X</code></td> <td>Angular momentum X</td> </tr> <tr> <td>68</td> <td><code>J2500c_Y</code></td> <td>Angular momentum Y</td> </tr> <tr> <td>69</td> <td><code>J2500c_Z</code></td> <td>Angular momentum Z</td> </tr> </tbody> </table> </section> </details></li> <li> <strong>Binary HDF5</strong> &mdash; containing the same information as the ASCII catalogues, plus particle data (IDs, coordinates, velocities, masses) within \(r &lt; 1.5\cdot R_{\mathrm{vir}}\). </li> </ol> <figure class="image"> <button type="button" class="zoom-trigger"> <img src="/assets/images/projects/cylindrical-simulation/LCDM_N24M_Halos_0032.svg" alt="SO overdensity halo catalogue at redshift 2.0" /> </button> <button type="button" class="zoom-trigger"> <img src="/assets/images/projects/cylindrical-simulation/LCDM_N24M_Halos_0137.svg" alt="SO overdensity halo catalogue at redshift 0.0" /> </button> <button type="button" class="zoom-trigger"> <img src="/assets/images/projects/cylindrical-simulation/LCDM_N24M_Halo42.svg" alt="Visualisation of halo #42 at redshift 0" /> </button> <!-- <figcaption>Figure caption placeholder.</figcaption> --> </figure> <p><strong>Mirrors</strong></p> <ul> <li>ELTE Kooplex (ASCII): TBA</li> <li>ELTE Kooplex (HDF5 + particles): TBA</li> <li>helsinkifi-my.sharepoint.com (ASCII): <a href="https://helsinkifi-my.sharepoint.com/:f:/g/personal/gracz_ad_helsinki_fi/IgBQLQnqx65HQpL1rxNQcSkSAVktbtJeXylQ8VSCqGyjyiU?e=rdBary">Download</a></li> <li>helsinkifi-my.sharepoint.com (HDF5 + particles): <a href="https://helsinkifi-my.sharepoint.com/:f:/g/personal/gracz_ad_helsinki_fi/IgATNo6G7U9UQIrlCrYaEt5hAcOt-QUn60tAH2EX2MpUfIE?e=D1nXgM">Download</a></li> </ul> <hr /> <h3 id="notebooks">Notebooks:</h3> <p>These <a href="https://jupyter.org/">jupyter</a> notebooks contain examples of how to load, visualise, and analyse the provided simulation data.</p> <p><strong>Mirrors</strong></p> <ul> <li>helsinkifi-my.sharepoint.com: <a href="https://helsinkifi-my.sharepoint.com/:u:/g/personal/gracz_ad_helsinki_fi/IQDupYMDLIydQo0EVBhcySmeAQKA7DdEPfH7kNjuERpCIDk?e=5fpamf">Download</a></li> </ul> <h2 id="companion-simulations">Companion simulations</h2> <p>These $S^1\times\mathbb{R}^2$ simulations were run with the same code and cosmological parameters as the simulation above, but with lower resolution and in smaller volumes. The purpose of these is to test analysis pipelines on much smaller datasets in $S^1\times\mathbb{R}^2$ topological manifold. The compressed files contain the initial conditions, the particle snapshots, the estimated power spectra, and the SO halo catalogues.</p> <div class="table-wrapper"> <table class="sim-table"> <colgroup> <col class="col-run" /> <col class="col-r" /> <col class="col-lz" /> <col class="col-np" /> <col class="col-size" /> <col class="col-download" /> </colgroup> <thead> <tr> <th>Run</th> <th>\(R_{\mathrm{sim}}\)</th> <th>\(L_{z}\)</th> <th>\(N_{p}\)</th> <th>Uncompressed Size</th> <th>Download</th> </tr> </thead> <tbody> <tr> <td>Small #1</td> <td>\(750\,\mathrm{Mpc}\)</td> <td>\(50.0\,\mathrm{Mpc}\)</td> <td>\(5.0\cdot10^5\)</td> <td>441&nbsp;MB</td> <td> <a href="https://helsinkifi-my.sharepoint.com/:u:/g/personal/gracz_ad_helsinki_fi/IQDa4_cUufnTRoDVMhIuzq6sAV3KJ8Kv4Jyd3bsoYkz8XvM?e=52UEaj"> Download </a> </td> </tr> <tr> <td>Small #2</td> <td>\(750\,\mathrm{Mpc}\)</td> <td>\(100.0\,\mathrm{Mpc}\)</td> <td>\(1.0\cdot10^6\)</td> <td>840&nbsp;MB</td> <td> <a href="https://helsinkifi-my.sharepoint.com/:u:/g/personal/gracz_ad_helsinki_fi/IQCs_FApczY7Q5lif0NxWDcFAYx2TUktwIeDCwHXJdJFZNM?e=3ousSP"> Download </a> </td> </tr> <tr> <td>Small #3</td> <td>\(750\,\mathrm{Mpc}\)</td> <td>\(200.0\,\mathrm{Mpc}\)</td> <td>\(2.0\cdot10^6\)</td> <td>1730&nbsp;MB</td> <td> <a href="https://helsinkifi-my.sharepoint.com/:u:/g/personal/gracz_ad_helsinki_fi/IQCP2rPKW-3wQLKuYMMDb2LdAQqYTQf0BmLjZJQ_4FP8Ijg?e=d60tRM"> Download </a> </td> </tr> </tbody> </table> </div> <p><strong>Particle mass range (all companion runs):</strong><br /> $M_{p} = 1.89 \cdot 10^{11}\,\mathrm{M_\odot} - 1.85 \cdot 10^{14}\,\mathrm{M_\odot}$.</p> </div> <dialog class="image-zoom-dialog"> <img src="" alt=""> <!-- Populated by zoom.js --> <form method="dialog"></form> </dialog> <script src="/assets/js/zoom.js"></script> </div> <footer> Website created and designed by @masterdesky &#8212; &copy; 2026&#8211;2026 </footer> </div> <!-- MathJax 2.x config --> <script type="text/javascript" async src="/assets/js/mathjax/mathjax-2-config.js"> </script> <script src="/assets/js/dereferrer.js"></script> </body> </html>
                


